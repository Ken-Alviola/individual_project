import numpy as np 
import pandas as pd 

def wrangle_semicon():
    df =  pd.read_csv('secom.data', sep=' ', header=None)
    labels = pd.read_csv('secom_labels.data', sep=' ', header=None)
    

    #features to keep based on coefficient of variance < 0.3 after minmax scaling and removing redundant columns (> 0.9 corr)
    keep_columns = [3,4,
                6,
                12,
                14,
                15,
                16,
                17,
                21,
                28,
                31,
                32,
                33,
                34,
                35,
                40,
                41,
                43,
                44,
                46,
                48,
                51,
                55,
                59,
                63,
                64,
                65,
                67,
                71,
                74,
                77,
                78,
                79,
                80,
                83,
                84,
                89,
                103,
                114,
                117,
                119,
                122,
                124,
                125,
                126,
                129,
                131,
                132,
                133,
                134,
                135,
                136,
                137,
                138,
                139,
                142,
                143,
                144,
                145,
                146,
                150,
                151,
                153,
                155,
                156,
                159,
                160,
                161,
                162,
                163,
                166,
                167,
                168,
                169,
                170,
                171,
                172,
                175,
                176,
                177,
                180,
                181,
                182,
                183,
                184,
                185,
                187,
                188,
                195,
                198,
                200,
                201,
                202,
                203,
                205,
                208,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219,
                221,
                222,
                223,
                224,
                225,
                227,
                228,
                238,
                239,
                248,
                250,
                251,
                253,
                254,
                255,
                267,
                268,
                269,
                316,
                367,
                368,
                412,
                418,
                419,
                423,
                430,
                432,
                433,
                438,
                439,
                460,
                468,
                472,
                473,
                474,
                476,
                480,
                482,
                483,
                484,
                485,
                486,
                487,
                488,
                489,
                496,
                499,
                500,
                510,
                511,
                521,
                542,
                543,
                544,
                546,
                548,
                549,
                550,
                551,
                555,
                558,
                559,
                560,
                562,
                563,
                564,
                565,
                572,
                573,
                582,
                583,
                586,
                587,
                589
                ]
    df = df[keep_columns]    
    
    df['timestamp'] = labels[1]
    datetime = df.timestamp.str.split(expand=True)
    df['date'] = datetime[0]
    df['time'] = datetime[1]
    df = df.drop(columns='timestamp')
    
    df['defect'] = labels[0]
    df.defect = df.defect.apply(lambda x: 0 if x == -1 else 1)
    
    df = df.fillna(df.mean())
    return df

